<div class="theme-container" [@listStagger]="items.length">
  <div class="toolbar-row mt-3">
    <div class="breadcrumbs">فروشگاه › همه محصولات</div>
    <!-- filters / sort can be added here -->
  </div>
  <div fxLayout="row wrap" class="agents-wrapper">
    <div fxLayout="row wrap" fxFlex="100" fxFlex.gt-sm="100">
      <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" fxFlex.sm="100" fxLayout="row wrap">
        <div fxFlex="100">
          <mat-card appearance="outlined">
            <div class="widget">
              <mat-card-title>
                <h4 class="pt-3 ps-3">
                  {{ 'PRODUCTS' | translate }}
                  {{ title }}
                </h4>
              </mat-card-title>
              <mat-card-content class="mt-3">
                <div class="grid">
                  <mat-card class="product-card" *ngFor="let product of items">
                    <div class="media" (click)="goToDetail(product)" role="button" tabindex="0">
                      <img mat-card-image [src]="product.image" [alt]="product.title" loading="lazy"/>
                    </div>
                    <mat-card-content>
                      <h3 class="title text-left" (click)="goToDetail(product)">{{ product.title }}</h3>
                      <div class="meta">
                        <span class="price" *ngIf="product.discount && product.discount > 0">
                          <span
                            class="final">{{ formatPrice(Math.round((product.price ?? 0) * (1 - (product.discount / 100)))) }}</span>
                          <span class="original">{{ formatPrice(product.price ?? 0) }}</span>
                        </span>
                        <span class="price" *ngIf="!product.discount || product.discount === 0">
                          <span class="final">{{ formatPrice(product.price ?? 0) }}</span>
                        </span>
                      </div>

                      <p class="desc">{{ product.description }}</p>
                    </mat-card-content>

                    <mat-card-actions class="card-actions">
                      <button mat-stroked-button color="primary" (click)="goToDetail(product)">جزئیات</button>
                      <!--<button mat-raised-button color="primary" (click)="goToDetail(product)">افزودن به سبد</button>-->
                      <app-cart-item-control
                        [relatedId]="product!.id"
                        [tableId]="Tables.Product"
                        [relatedName]="product!.title"
                        [unitPrice]="product!.price ?? 0"
                        [stock]="product!.stock ?? 99999999">
                      </app-cart-item-control>
                    </mat-card-actions>
                  </mat-card>
                </div>
              </mat-card-content>
            </div>
          </mat-card>
        </div>
        <div *ngIf="items?.length" fxFlex="100" fxLayoutAlign="center center">
          <app-load-more [step]="1"></app-load-more>
        </div>
      </div>
    </div>
  </div>
</div>
