@if (product) {
  <app-header-image
    [backgroundImage]="product.image"
    [bgImageAnimate]="false"
    [contentOffsetToTop]="true"
    [hideMask]="true"
    [contentMinHeight]="400"
    [title]="''"
    [desc]="''">
  </app-header-image>
  <div class="theme-container">
    <div class="py-3">
      <nav class="breadcrumb">فروشگاه › {{ product.productCategoryTitle }} › {{ product.title }}</nav>
      <div fxLayout="row wrap">
        @if ((product.images?.length ?? 0) > 0) {
          <div class="gallery pe-2" fxFlex="100" fxFlex.gt-md="60">
            <div class="main-image">
              <img [src]="selectedImage" alt="{{ product.title }}" loading="lazy">
            </div>
            <div class="thumbs">
              <button *ngFor="let g of product.images" (click)="selectImage(g)"
                      [class.active]="g.path === selectedImage">
                <img [src]="g.path" alt="thumb" loading="lazy">
              </button>
            </div>
          </div>
        }
        <div class="info ps-2" fxFlex="100"
             [fxFlex.gt-md]="(product.images?.length ?? 0) > 0 ? 40 : 100">
          <h1>{{ product.title }}</h1>
          @if (product.price > 0) {
            <div class="price-row">
              <div class="price">
                <span class="final">{{ product }}</span>
                <span class="original" *ngIf="product.discount > 0">{{ product.price }}</span>
                <span>{{ 'TOMAN' | translate }}</span>
              </div>
            </div>
          }
          <div *ngIf="product.guarantyExpirationTime > 0">
            <b><u>{{ product.guarantyExpirationTime }}</u></b>
            سال گارانتی
          </div>
          <div *ngIf="product.periodicServiceInterval > 0">
            سرویس دوره ای هر
            <b><u>{{ product.periodicServiceInterval }}</u></b>
            ماه
          </div>
          @if (product) {
            <app-cart-item-control
              [relatedId]="product!.id"
              [tableId]="Tables.Product"
              [relatedName]="product!.title"
              [unitPrice]="product!.price ?? 0"
              [stock]="product!.stock ?? 99999999">
            </app-cart-item-control>
          }
          <mat-tab-group class="spec-tabs">
            <mat-tab label="توضیحات">
              <div class="tab-body">
                <p [innerHTML]="product.description | safeHtml"></p>
              </div>
            </mat-tab>
          </mat-tab-group>
        </div>
      </div>
    </div>
  </div>
} @else {
  <div class="loading container">در حال بارگذاری...</div>
}
