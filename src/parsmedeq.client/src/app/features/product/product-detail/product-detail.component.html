@if (product) {
  <app-header-image
    [backgroundImage]="coverImage"
    [bgImageAnimate]="false"
    [contentOffsetToTop]="true"
    [hideMask]="true"
    [contentMinHeight]="400"
    [title]="''"
    [desc]="''">
  </app-header-image>
  <div class="theme-container">
    <div class="py-3">
      <nav class="breadcrumb">فروشگاه › {{ product.category }} › {{ product.title }}</nav>
      <div fxLayout="row wrap">
        <div class="gallery pe-2" fxFlex="100" fxFlex.gt-md="60">
          <div class="main-image">
            <img [src]="selectedImage || product.coverImage" alt="{{ product.title }}" loading="lazy">
          </div>
          <div class="thumbs">
            <button *ngFor="let g of product.gallery" (click)="selectImage(g)" [class.active]="g===selectedImage">
              <img [src]="g" alt="thumb" loading="lazy">
            </button>
          </div>
        </div>
        <div class="info ps-2" fxFlex="100" fxFlex.gt-md="40">
          <h1>{{ product.title }}</h1>
          <div class="price-row">
            <div class="price">
              <span class="final">{{ formatPrice(finalPrice(product)) }}</span>
              <span class="original" *ngIf="product.discountPercent && product.discountPercent>0">{{ formatPrice(product.price) }}</span>
            </div>
            <div class="stock" [class.out]="!product.inStock">{{ product.inStock ? 'موجود' : 'ناموجود' }}</div>
          </div>

          <p class="short-desc">{{ product.description }}</p>

          <div class="actions">
            <mat-form-field appearance="outline" class="qty">
              <input matInput type="number" min="1" [(ngModel)]="quantity">
            </mat-form-field>

            <button mat-raised-button color="primary">افزودن به سبد</button>
          </div>

          <mat-tab-group class="spec-tabs">
            <mat-tab label="توضیحات">
              <div class="tab-body">
                <p>{{ product.description }}</p>
              </div>
            </mat-tab>
            <mat-tab label="مشخصات">
              <div class="tab-body specs">
                <table>
                  <tbody>
                  <tr *ngFor="let s of product.specifications">
                    <td class="key">{{ s.key }}</td>
                    <td class="val">{{ s.value }}</td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </mat-tab>
            <mat-tab label="گالری">
              <div class="tab-body gallery-tab">
                <div class="gallery-grid">
                  <img *ngFor="let g of product.gallery" [src]="g" loading="lazy" alt="">
                </div>
              </div>
            </mat-tab>
          </mat-tab-group>
        </div>
      </div>
    </div>
  </div>
} @else {
  <div class="loading container">در حال بارگذاری...</div>
}
